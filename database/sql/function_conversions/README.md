# SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-07  
**–ß–∞—Ç:** –§—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö  
**–ü—Ä–∏–Ω—Ü–∏–ø:** metadataFirst  

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π MS SQL ‚Üí PostgreSQL —á–µ—Ä–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
function_conversions (—Ä–æ–¥–∏—Ç–µ–ª—å - 11 –ø–æ–ª–µ–π)
‚îú‚îÄ‚îÄ column_function_conversions (column_id FK)
‚îú‚îÄ‚îÄ default_constraint_function_conversions (constraint_id FK)
‚îú‚îÄ‚îÄ check_constraint_function_conversions (constraint_id FK)
‚îî‚îÄ‚îÄ index_function_conversions (index_id FK + —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ)
```

---

## üìÅ –§–∞–π–ª—ã

### 00_run_all.sql
–ú–∞—Å—Ç–µ—Ä-—Å–∫—Ä–∏–ø—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
psql -U postgres -d fish_eye -f 00_run_all.sql
```

### 01_create_parent_table.sql
–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã `function_conversions`.

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- 11 –ø–æ–ª–µ–π (source_definition, target_definition, mapping_*, manual_*)
- 5 –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- 8 —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –ü–æ–ª–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### 02_create_child_tables.sql
–°–æ–∑–¥–∞–Ω–∏–µ 4 –¥–æ—á–µ—Ä–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ INHERITS.

**–¢–∞–±–ª–∏—Ü—ã:**
- column_function_conversions
- default_constraint_function_conversions
- check_constraint_function_conversions
- index_function_conversions

**–ö–∞–∂–¥–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç:** –¢–û–õ–¨–ö–û FK —Å–≤—è–∑—å + –Ω–∞—Å–ª–µ–¥—É–µ–º—ã–µ 11 –ø–æ–ª–µ–π

### 03_migrate_existing_data.sql
–ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–∫—É—â–∏—Ö –ø–æ–ª–µ–π.

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- postgres_columns (67 –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –∫–æ–ª–æ–Ω–æ–∫)
- postgres_default_constraints (~49 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- postgres_check_constraints (~31 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ)
- postgres_indexes (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)

### 04_create_views.sql
–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

**–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:**
- v_function_conversions_typed - —Å —Ç–∏–ø–æ–º –æ–±—ä–µ–∫—Ç–∞
- v_function_conversions_full - –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è + –∏–º–µ–Ω–∞ –æ–±—ä–µ–∫—Ç–æ–≤

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
cd /home/alex/projects/sql/femcl/database/sql/function_conversions
psql -U postgres -d fish_eye -f 00_run_all.sql
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ:
- 5 —Ç–∞–±–ª–∏—Ü (1 —Ä–æ–¥–∏—Ç–µ–ª—å + 4 –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞)
- 2 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (~67 –∫–æ–ª–æ–Ω–æ–∫)

---

**–ê–≤—Ç–æ—Ä:** –°–∏—Å—Ç–µ–º–∞ FEMCL  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** docs/project/project-docs.json ‚Üí database.controlSchema.functionConversion
