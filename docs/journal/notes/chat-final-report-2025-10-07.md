# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: –ß–∞—Ç "–§—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö"

**–î–∞—Ç–∞:** 2025-10-07  
**–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:** DEVELOPMENT MODE  
**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –≤ –æ–±—ä–µ–∫—Ç–∞—Ö —Ç–∞–±–ª–∏—Ü MS SQL ‚Üí PostgreSQL  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Phase 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é

---

## üéØ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –†–ê–ë–û–¢–´

### Phase 1: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ

**1. –ü—Ä–∏–Ω—Ü–∏–ø metadataFirst**
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ `project-docs.json`
- –í—Å–µ –∏–º–µ–Ω–∞ –∏ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ 02.01
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ç–∞–¥–∏–∏ 02.02 —Ç–æ–ª—å–∫–æ –ß–ò–¢–ê–ï–¢ –≥–æ—Ç–æ–≤—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

**2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏**
- Parent-child inheritance –º–æ–¥–µ–ª—å (PostgreSQL)
- `postgres_function_conversions` (—Ä–æ–¥–∏—Ç–µ–ª—å) + 4 –¥–æ—á–µ—Ä–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- `source_definition`, `target_definition` –≤ —Ä–æ–¥–∏—Ç–µ–ª–µ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏
- 8 —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (pending ‚Üí automatic/manual ‚Üí completed)

**3. AI –ø—Ä–∞–≤–∏–ª–∞**
- –°–æ–∑–¥–∞–Ω `src/ai-rules/metadata/function-conversion-rules.md`
- –û–±–Ω–æ–≤–ª–µ–Ω `.cursorrules` —Å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —Ä–∞–±–æ—Ç—ã
- –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è automatic –∏ manual —Ä–µ–∂–∏–º–æ–≤

---

### Phase 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ë–î ‚úÖ

**1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (5 —à—Ç)**
```
‚úÖ postgres_function_conversions (—Ä–æ–¥–∏—Ç–µ–ª—å)
‚úÖ postgres_column_function_conversions
‚úÖ postgres_default_constraint_function_conversions
‚úÖ postgres_check_constraint_function_conversions
‚úÖ postgres_index_function_conversions
```

**2. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: 147 –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
  - 67 –∫–æ–ª–æ–Ω–æ–∫
  - 49 DEFAULT constraints
  - 31 CHECK constraints
  - 0 indexes (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)

**3. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
- `v_function_conversions_typed` (—Å —Ç–∏–ø–æ–º –æ–±—ä–µ–∫—Ç–∞)
- `v_function_conversions_full` (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)

**4. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º postgres_**
- –í—Å–µ 5 —Ç–∞–±–ª–∏—Ü —Ç–µ–ø–µ—Ä—å —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `postgres_`
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –∏ constraints

**5. –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–æ–ª–µ–π**
- –£–¥–∞–ª–µ–Ω–æ: 16 —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π (4 –ø–æ–ª—è √ó 4 —Ç–∞–±–ª–∏—Ü—ã)
- –£–¥–∞–ª–µ–Ω–æ: 2 –∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- –û—Å—Ç–∞–≤–ª–µ–Ω–æ: 4 –ø–æ–ª—è `postgres_definition` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ë–î

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

**–¢–∞–±–ª–∏—Ü—ã –æ–±—ä–µ–∫—Ç–æ–≤:**
```
postgres_columns:
  ‚úÖ computed_definition           ‚Üê –ò–°–•–û–î–ù–ò–ö (MS SQL)
  ‚úÖ postgres_computed_definition  ‚Üê –†–ï–ó–£–õ–¨–¢–ê–¢ (PostgreSQL)

postgres_default_constraints:
  ‚úÖ definition                    ‚Üê –ò–°–•–û–î–ù–ò–ö
  ‚úÖ postgres_definition           ‚Üê –†–ï–ó–£–õ–¨–¢–ê–¢

postgres_check_constraints:
  ‚úÖ definition                    ‚Üê –ò–°–•–û–î–ù–ò–ö
  ‚úÖ postgres_definition           ‚Üê –†–ï–ó–£–õ–¨–¢–ê–¢

postgres_indexes:
  ‚úÖ postgres_definition           ‚Üê –†–ï–ó–£–õ–¨–¢–ê–¢
```

**–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:**
```
postgres_function_conversions (—Ä–æ–¥–∏—Ç–µ–ª—å):
  ‚úÖ source_definition             ‚Üê –ò—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
  ‚úÖ target_definition             ‚Üê –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
  ‚úÖ mapping_rule_id               ‚Üê FK –∫ function_mapping_rules
  ‚úÖ mapping_status                ‚Üê –°—Ç–∞—Ç—É—Å (8 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
  ‚úÖ mapping_complexity            ‚Üê –°–ª–æ–∂–Ω–æ—Å—Ç—å
  ‚úÖ manual_developer              ‚Üê –ö—Ç–æ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª (–¥–ª—è manual)
  ‚úÖ manual_started_at             ‚Üê –ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª
  ‚úÖ manual_completed_at           ‚Üê –ö–æ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–∏–ª
  ‚úÖ mapping_notes                 ‚Üê –ó–∞–º–µ—Ç–∫–∏

–î–æ—á–µ—Ä–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (4 —à—Ç):
  ‚úÖ –ù–∞—Å–ª–µ–¥—É—é—Ç –≤—Å–µ –ø–æ–ª—è –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
  ‚úÖ –°–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π FK –∫ —Å–≤–æ–µ–º—É –æ–±—ä–µ–∫—Ç—É
  ‚úÖ column_id, constraint_id, index_id
```

---

## üìÅ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø (–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (10 —Ñ–∞–π–ª–æ–≤):

**–ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞:**
1. ‚úÖ `function-analysis-2025-10-07.md` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (67 –∫–æ–ª–æ–Ω–æ–∫)
2. ‚úÖ `verification-summary-2025-10-07.md` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
3. ‚úÖ `function-conversion-final-architecture-2025-10-07.md` - –ì–õ–ê–í–ù–´–ô –†–ï–§–ï–†–ï–ù–°

**–û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**
4. ‚úÖ `legacy-fk-cleanup-proposal-2025-10-07.md` - –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
5. ‚úÖ `legacy-fields-check-report-2025-10-07.md` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
6. ‚úÖ `legacy-fields-cleanup-summary-2025-10-07.md` - –ò—Ç–æ–≥–∏ –æ—á–∏—Å—Ç–∫–∏

**–ò—Ç–æ–≥–∏:**
7. ‚úÖ `phase2-final-summary-2025-10-07.md` - –ò—Ç–æ–≥–∏ Phase 2
8. ‚úÖ `chat-summary-functions-in-columns-2025-10-07.md` - –û–±—â–∞—è —Å–≤–æ–¥–∫–∞
9. ‚úÖ `cleanup-proposal-2025-10-07.md` - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –æ—á–∏—Å—Ç–∫–µ
10. ‚úÖ `chat-final-report-2025-10-07.md` - –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

**–£–¥–∞–ª–µ–Ω–æ (7 –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö):**
- function-mapping-proposals (v1, v2, normalized)
- function-conversion-fk-solutions
- phase1/phase2 –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–≤–æ–¥–∫–∏
- table-naming-proposal

---

## üíæ SQL –°–ö–†–ò–ü–¢–´ (–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (6 —Ñ–∞–π–ª–æ–≤):

1. ‚úÖ `01_create_parent_table.sql` - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã
2. ‚úÖ `02_create_child_tables.sql` - –°–æ–∑–¥–∞–Ω–∏–µ 4 –¥–æ—á–µ—Ä–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü
3. ‚úÖ `03_migrate_existing_data.sql` - –ú–∏–≥—Ä–∞—Ü–∏—è 147 –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
4. ‚úÖ `04_create_views.sql` - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
5. ‚úÖ `08_cleanup_legacy_fields.sql` - –£–¥–∞–ª–µ–Ω–∏–µ 16 —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π
6. ‚úÖ `README.md` - –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

**–£–¥–∞–ª–µ–Ω–æ (8 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö):**
- 00_run_all.sql (–º–∞—Å—Ç–µ—Ä-—Å–∫—Ä–∏–ø—Ç)
- 05-07 —Å–∫—Ä–∏–ø—Ç—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- execute_all.py, execute_rename.py, finish_rename.py

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –†–ê–ë–û–¢–´

**–°–æ–∑–¥–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 17 (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ 10, —É–¥–∞–ª–µ–Ω–æ 7)  
**–°–æ–∑–¥–∞–Ω–æ SQL —Å–∫—Ä–∏–ø—Ç–æ–≤:** 14 (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ 6, —É–¥–∞–ª–µ–Ω–æ 8)  
**–°–æ–∑–¥–∞–Ω–æ Python —Å–∫—Ä–∏–ø—Ç–æ–≤:** 3 (—É–¥–∞–ª–µ–Ω–æ 3)  

**–°–æ–∑–¥–∞–Ω–æ —Ç–∞–±–ª–∏—Ü –ë–î:** 5  
**–ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π:** 147  
**–£–¥–∞–ª–µ–Ω–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π:** 16  
**–£–¥–∞–ª–µ–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π:** 2  

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ –∫–æ–¥–∞:** 200+  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞:** 3 (project-docs.json, .cursorrules, project-journal.json)  

---

## ‚úÖ –î–û–°–¢–ò–ì–ù–£–¢–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î ‚úÖ

**–î–æ:**
- –§—É–Ω–∫—Ü–∏–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å "–∫–∞–∫ –µ—Å—Ç—å" –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –ù–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ 4 —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä—É—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ü–æ—Å–ª–µ:**
- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–ª–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ (8 —Å—Ç–∞—Ç—É—Å–æ–≤)
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏ —Ä—É—á–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–∫—Ç–æ, –∫–æ–≥–¥–∞, –∫–∞–∫)

### 2. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã ‚úÖ

**metadataFirst:**
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ 02.01
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ç–∞–¥–∏–∏ 02.02 —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –î–≤–∞ —Ä–µ–∂–∏–º–∞: automatic (–ø—Ä–∞–≤–∏–ª–∞) + manual (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ —á–∞—Ç–µ)

**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–±—ä–µ–∫—Ç—ã: –ò—Å—Ö–æ–¥–Ω–∏–∫ + –†–µ–∑—É–ª—å—Ç–∞—Ç
- Conversions: –ü—Ä–æ—Ü–µ—Å—Å + –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ + –ò—Å—Ç–æ—Ä–∏—è

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- `project-docs.json` (–ø—Ä–∏–Ω—Ü–∏–ø—ã, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Å—Ç–∞–¥–∏–∏)
- `src/ai-rules/metadata/function-conversion-rules.md` (–ø—Ä–∞–≤–∏–ª–∞ AI)
- `.cursorrules` (–ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã –≤ IDE)
- `project-journal.json` (8 actions –≤ —á–∞—Ç–µ)

**–°–æ–∑–¥–∞–Ω–æ:**
- 10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç—á–µ—Ç–æ–≤
- 6 SQL —Å–∫—Ä–∏–ø—Ç–æ–≤ (DDL + DML + –æ—á–∏—Å—Ç–∫–∞)

---

## üîú –°–õ–ï–î–£–Æ–©–ò–ï –§–ê–ó–´

### Phase 3: Python –∫–ª–∞—Å—Å—ã (pending) ~5h

**–ó–∞–¥–∞—á–∏:**
- –ö–ª–∞—Å—Å `FunctionConverter` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è)
- –ö–ª–∞—Å—Å `MetadataTransformer` (—Ä–∞–±–æ—Ç–∞ —Å postgres_function_conversions)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 147 –∑–∞–ø–∏—Å—è—Ö

**–§–∞–π–ª—ã:**
- `src/code/migration/classes/function_converter.py`
- `src/code/migration/classes/metadata_transformer.py`

---

### Phase 4: –†—É—á–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (pending) ~8h

**–ó–∞–¥–∞—á–∏:**
- 25 —Ñ—É–Ω–∫—Ü–∏–π [ags] —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –†–∞–±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ manual (–∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∫–æ–¥)
- start_manual() ‚Üí —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Üí complete_manual()
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ manual_developer, manual_*_at

**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
- `[ags].[fn_ActualPrice]`
- `[ags].[fn_DaysByKurs]`
- `[ags].[fn_EndDate]`
- ... (–≤—Å–µ–≥–æ 25 —Ñ—É–Ω–∫—Ü–∏–π)

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –†–ï–®–ï–ù–ò–Ø

### 1. Parent-child inheritance

**–ü–æ—á–µ–º—É:**
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–π
- Type-safe FK (–∫–∞–∂–¥–∞—è –¥–æ—á–µ—Ä–Ω—è—è —Ç–∞–±–ª–∏—Ü–∞ –∑–Ω–∞–µ—Ç —Å–≤–æ–π —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ —Ä–æ–¥–∏—Ç–µ–ª—è

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω—ã:**
- 4 separate FKs (—Å–ª–æ–∂–Ω–æ, –Ω–µ—è—Å–Ω–æ –∫–∞–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
- Intermediate link tables (–ª–∏—à–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)

### 2. source_definition, target_definition –≤ —Ä–æ–¥–∏—Ç–µ–ª–µ

**–ü–æ—á–µ–º—É:**
- –ï–¥–∏–Ω—ã–π API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
- –ù–µ –Ω—É–∂–Ω—ã 4 —Ä–∞–∑–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
- –ü—Ä–æ—â–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞:**
- –í –¥–æ—á–µ—Ä–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö (–∑–∞—Ç—Ä—É–¥–Ω–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É)

### 3. –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–æ–ª–µ–π

**–ü–æ—á–µ–º—É:**
- –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ß—Ç–æ –æ—Å—Ç–∞–≤–∏–ª–∏:**
- postgres_definition –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (—Å—Ç–∞–¥–∏—è 02.02)

---

## üìä –§–ò–ù–ê–õ–¨–ù–´–ï –¶–ò–§–†–´

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –¢–∞–±–ª–∏—Ü: 5 (1 —Ä–æ–¥–∏—Ç–µ–ª—å + 4 –¥–µ—Ç–µ–π)
- –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π: 2
- –ò–Ω–¥–µ–∫—Å–æ–≤: 15+ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã)
- FK constraints: 10+ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã)

**–î–∞–Ω–Ω—ã–µ:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π: 147
  - –ö–æ–ª–æ–Ω–æ–∫: 67
  - DEFAULT: 49
  - CHECK: 31
  - INDEX: 0

**–°—Ç–∞—Ç—É—Å—ã:**
- automatic-mapped: 42 –∫–æ–ª–æ–Ω–∫–∏
- pending: 25 –∫–æ–ª–æ–Ω–æ–∫ (—Ñ—É–Ω–∫—Ü–∏–∏ [ags])
- manual-required: 0 (–±—É–¥—É—Ç –æ—Ç–º–µ—á–µ–Ω—ã)

**–ü—Ä–∞–≤–∏–ª–∞ –º–∞–ø–ø–∏–Ω–≥–∞:**
- –ì–æ—Ç–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª: 18
- –ë–µ–∑ –ø—Ä–∞–≤–∏–ª: 15 —Ñ—É–Ω–∫—Ü–∏–π [ags]

---

## ‚úÖ –ö–ê–ß–ï–°–¢–í–û –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã:

**–ö–æ–¥:**
- ‚úÖ –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π –≤ SQL
- ‚úÖ Python –∫–ª–∞—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ –∞—Ç—Ä–∏–±—É—Ç—ã –≤ –ø–∞–º—è—Ç–∏
- ‚úÖ 200+ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

**–ë–î:**
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (147 = 67+49+31+0)
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –í—Å–µ FK –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- ‚úÖ project-docs.json –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ project-journal.json –æ–±–Ω–æ–≤–ª–µ–Ω
- ‚úÖ AI –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ 10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏—Ç–æ–≥–æ–≤

---

## üéâ –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### ‚úÖ Phase 2 –ó–ê–í–ï–†–®–ï–ù–ê –ü–û–õ–ù–û–°–¢–¨–Æ

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î
- ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏–Ω—Ü–∏–ø metadataFirst
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã AI –ø—Ä–∞–≤–∏–ª–∞
- ‚úÖ –û—á–∏—â–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

**–ö–∞—á–µ—Å—Ç–≤–æ:**
- ‚úÖ –ù–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è
- ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ Phase 3

**–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~6 —á–∞—Å–æ–≤  
**–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 34  
**–§–∞–π–ª–æ–≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö:** 16  
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞/–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** ~5000

---

## üìã –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ì–û –ß–ê–¢–ê

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è Phase 3:

**–ì–æ—Ç–æ–≤–æ:**
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã postgres_function_conversions —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –î–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã (147 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ AI –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞–Ω—ã

**–ù—É–∂–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å:**
1. `FunctionConverter` –∫–ª–∞—Å—Å
2. `MetadataTransformer` –∫–ª–∞—Å—Å
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TableModel
4. –¢–µ—Å—Ç—ã

**–†–µ—Ñ–µ—Ä–µ–Ω—Å—ã:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: `function-conversion-final-architecture-2025-10-07.md`
- AI –ø—Ä–∞–≤–∏–ª–∞: `src/ai-rules/metadata/function-conversion-rules.md`
- –ë–î: `postgres_function_conversions` + 4 –¥–æ—á–µ—Ä–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

**–ì–ª–∞–≤–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã:**
1. `function-conversion-final-architecture-2025-10-07.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
2. `src/ai-rules/metadata/function-conversion-rules.md` - AI –ø—Ä–∞–≤–∏–ª–∞
3. `phase2-final-summary-2025-10-07.md` - –ò—Ç–æ–≥–∏ —Ñ–∞–∑—ã
4. `chat-summary-functions-in-columns-2025-10-07.md` - –°–≤–æ–¥–∫–∞ —á–∞—Ç–∞

**–ê–Ω–∞–ª–∏–∑:**
- `function-analysis-2025-10-07.md` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- `legacy-fk-cleanup-proposal-2025-10-07.md` - –†–µ—à–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–∫—Ä–∏–ø—Ç—ã:**
- `database/sql/function_conversions/01-04,08.sql` - DDL/DML
- `database/sql/function_conversions/README.md` - –û–ø–∏—Å–∞–Ω–∏–µ

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-10-07  
**–ß–∞—Ç:** –§—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö  
**–†–µ–∂–∏–º:** DEVELOPMENT MODE  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Phase 2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≥–æ—Ç–æ–≤–æ –∫ Phase 3  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Python –∫–ª–∞—Å—Å–æ–≤ –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ
