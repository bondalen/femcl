# üìã –ü–†–ê–í–ò–õ–ê –°–û–ó–î–ê–ù–ò–Ø –¢–ê–ë–õ–ò–¶–´ –í –¶–ï–õ–ï–í–û–ô –ë–î

## üéØ –¶–µ–ª—å
–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏ –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ —Ü–µ–ª–µ–≤–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (—Å—Ö–µ–º–∞ `ags`) –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ —Å—Ö–µ–º–µ `mcl`.

## üèóÔ∏è –ò–µ—Ä–∞—Ä—Ö–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å—Ö–µ–º–µ MCL

### **–ò—Å—Ö–æ–¥–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (MS SQL Server):**
```
mssql_objects (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞)
‚îú‚îÄ‚îÄ mssql_tables (—Ç–∞–±–ª–∏—Ü—ã)
‚îú‚îÄ‚îÄ mssql_columns (–∫–æ–ª–æ–Ω–∫–∏)
‚îú‚îÄ‚îÄ mssql_indexes (–∏–Ω–¥–µ–∫—Å—ã)
‚îú‚îÄ‚îÄ mssql_primary_keys (–ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏)
‚îú‚îÄ‚îÄ mssql_foreign_keys (–≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏)
‚îî‚îÄ‚îÄ mssql_constraints (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
```

### **–¶–µ–ª–µ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã (PostgreSQL):**
```
postgres_objects (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞)
‚îú‚îÄ‚îÄ postgres_tables (—Ç–∞–±–ª–∏—Ü—ã)
‚îú‚îÄ‚îÄ postgres_columns (–∫–æ–ª–æ–Ω–∫–∏)
‚îú‚îÄ‚îÄ postgres_indexes (–∏–Ω–¥–µ–∫—Å—ã)
‚îú‚îÄ‚îÄ postgres_primary_keys (–ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏)
‚îú‚îÄ‚îÄ postgres_foreign_keys (–≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏)
‚îî‚îÄ‚îÄ postgres_constraints (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
```

## üìä –ü–†–û–¶–ï–°–° –°–û–ó–î–ê–ù–ò–Ø –¢–ê–ë–õ–ò–¶–´

### **–≠—Ç–∞–ø 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã**

#### **1.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ mssql_tables
SELECT id, object_name, object_type, schema_name
FROM mcl.mssql_tables 
WHERE id = [TABLE_ID];
```

#### **1.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤ postgres_tables
SELECT id, object_name, object_type, schema_name
FROM mcl.postgres_tables 
WHERE id = [TARGET_TABLE_ID];
```

#### **1.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–æ–Ω–∫–∞—Ö –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
SELECT 
    mc.column_name,
    mc.ordinal_position,
    mc.is_identity,
    mc.default_value
FROM mcl.mssql_tables mt
JOIN mcl.mssql_columns mc ON mt.id = mc.table_id
WHERE mt.id = [TABLE_ID]
ORDER BY mc.ordinal_position;
```

#### **1.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–æ–Ω–∫–∞—Ö —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
SELECT 
    pc.column_name,
    pc.ordinal_position,
    pdt.typname_with_params as postgres_type,
    pc.is_identity,
    pc.default_value
FROM mcl.postgres_tables pt
JOIN mcl.postgres_columns pc ON pt.id = pc.table_id
JOIN mcl.postgres_derived_types pdt ON pc.postgres_data_type_id = pdt.id
WHERE pt.id = [TARGET_TABLE_ID]
ORDER BY pc.ordinal_position;
```

### **–≠—Ç–∞–ø 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã**

#### **2.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DDL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã**
```sql
CREATE TABLE ags.[table_name] (
    [column_definitions]
    [constraints]
);
```

#### **2.2 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫**
- **IDENTITY –∫–æ–ª–æ–Ω–∫–∏:** `GENERATED ALWAYS AS IDENTITY`
- **NOT NULL –∫–æ–ª–æ–Ω–∫–∏:** `NOT NULL`
- **DEFAULT –∑–Ω–∞—á–µ–Ω–∏—è:** `DEFAULT [value]`
- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ `postgres_derived_types.typname_with_params`

#### **2.3 –ü–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏**
- **IDENTITY –∫–æ–ª–æ–Ω–∫–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è PRIMARY KEY
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏:** `PRIMARY KEY (col1, col2, ...)`

### **–≠—Ç–∞–ø 3: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL**

#### **3.1 –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DDL**
```sql
-- –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã accnt
CREATE TABLE ags.accnt (
    account_key INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    account_num INTEGER NOT NULL,
    account_name VARCHAR(255) NOT NULL
);
```

#### **3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
SELECT 
    table_schema,
    table_name,
    column_name,
    data_type,
    is_nullable,
    column_default
FROM information_schema.columns 
WHERE table_schema = 'ags' AND table_name = '[table_name]'
ORDER BY ordinal_position;
```

#### **3.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤**
```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
SELECT 
    indexname,
    indexdef
FROM pg_indexes 
WHERE schemaname = 'ags' AND tablename = '[table_name]';
```

## üîç –ü–†–û–í–ï–†–ö–ò –ö–ê–ß–ï–°–¢–í–ê

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. ‚úÖ **–¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ö–µ–º–µ (`ags`)
2. ‚úÖ **–í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–∑–¥–∞–Ω—ã** —Å–æ–≥–ª–∞—Å–Ω–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º
3. ‚úÖ **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç** —Ü–µ–ª–µ–≤—ã–º —Ç–∏–ø–∞–º
4. ‚úÖ **–ü–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏ —Å–æ–∑–¥–∞–Ω—ã** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. ‚úÖ **IDENTITY –∫–æ–ª–æ–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** –ø—Ä–∞–≤–∏–ª—å–Ω–æ
6. ‚úÖ **NOT NULL –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. üîç **–ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã** (–µ—Å–ª–∏ –µ—Å—Ç—å)
2. üîç **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã** (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. üîç **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã** (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üìù –®–ê–ë–õ–û–ù DDL –î–õ–Ø –¢–ê–ë–õ–ò–¶–´

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã [table_name] –≤ —Å—Ö–µ–º–µ ags
CREATE TABLE ags.[table_name] (
    [column_name] [data_type] [constraints],
    [column_name] [data_type] [constraints],
    [column_name] [data_type] [constraints],
    PRIMARY KEY ([primary_key_columns])
);

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
CREATE INDEX [index_name] ON ags.[table_name] ([column_name]);

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
ALTER TABLE ags.[table_name] 
ADD CONSTRAINT [constraint_name] [constraint_definition];
```

## üö® –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´

### **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã:**
- **IDENTITY –∫–æ–ª–æ–Ω–∫–∏:** –í—Å–µ–≥–¥–∞ `GENERATED ALWAYS AS IDENTITY`
- **–ü–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è IDENTITY –∫–æ–ª–æ–Ω–æ–∫
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏:** –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ DDL

### **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:**
- **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∏–ø—ã** –∏–∑ `postgres_derived_types.typname_with_params`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∏–ø–æ–≤** (–¥–ª–∏–Ω–∞, —Ç–æ—á–Ω–æ—Å—Ç—å) —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- **NULL/NOT NULL** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### **–°—Ö–µ–º–∞:**
- **–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è** –≤ —Å—Ö–µ–º–µ `ags`
- **–°—Ö–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å** –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `postgres`

## üìä –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ò –û–¢–ß–ï–¢–ù–û–°–¢–¨

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏:**
1. üìù **–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è** —Ç–∞–±–ª–∏—Ü—ã
2. üìù **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫** —Å–æ–∑–¥–∞–Ω–æ
3. üìù **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤** —Å–æ–∑–¥–∞–Ω–æ
4. üìù **–û—à–∏–±–∫–∏** (–µ—Å–ª–∏ –µ—Å—Ç—å)
5. üìù **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** (–µ—Å–ª–∏ –µ—Å—Ç—å)

### **–§–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞:**
```markdown
## üìã –û–¢–ß–ï–¢ –û –°–û–ó–î–ê–ù–ò–ò –¢–ê–ë–õ–ò–¶–´ [table_name]

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: –£–°–ü–ï–®–ù–û
- **–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è:** [timestamp]
- **–°—Ö–µ–º–∞:** ags
- **–ö–æ–ª–æ–Ω–æ–∫:** [count]
- **–ò–Ω–¥–µ–∫—Å–æ–≤:** [count]
- **–û—à–∏–±–æ–∫:** 0

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|---------|-----|-------------|
| [col1] | [type1] | [constraints1] |
| [col2] | [type2] | [constraints2] |
```

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã:
1. **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å** –≤ `postgres_tables.status = 'created'`
2. **–ó–∞–ø–∏—Å–∞—Ç—å –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è** –≤ `postgres_tables.created_at`
3. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É** –∫ —Å–æ–∑–¥–∞–Ω–∏—é
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** [current_date]  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** FEMCL Migration System
