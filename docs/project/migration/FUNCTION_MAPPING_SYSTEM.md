# üîß –°–ò–°–¢–ï–ú–ê –ú–ê–ü–ü–ò–ù–ì–ê –§–£–ù–ö–¶–ò–ô FEMCL

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã
–°–∏—Å—Ç–µ–º–∞ –º–∞–ø–ø–∏–Ω–≥–∞ —Ñ—É–Ω–∫—Ü–∏–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ MS SQL Server —Ñ—É–Ω–∫—Ü–∏–π –≤ –∏—Ö PostgreSQL –∞–Ω–∞–ª–æ–≥–∏ –Ω–∞ —ç—Ç–∞–ø–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤–∏–ª –º–∞–ø–ø–∏–Ω–≥–∞ (`mcl.function_mapping_rules`)
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** –ò—Å—Ö–æ–¥–Ω–∞—è MS SQL Server —Ñ—É–Ω–∫—Ü–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `getdate`, `isnull`)
- **–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:** PostgreSQL —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `NOW`, `COALESCE`)
- **–¢–∏–ø –º–∞–ø–ø–∏–Ω–≥–∞:** `direct` (–ø—Ä—è–º–∞—è –∑–∞–º–µ–Ω–∞) –∏–ª–∏ `regex` (—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ)
- **–ü—Ä–∏–º–µ–Ω–∏–º—ã–µ –æ–±—ä–µ–∫—Ç—ã:** `default_constraint`, `computed_column`, `check_constraint`, `index`

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **`postgres_default_constraints`**: –ø–æ–ª–µ `function_mapping_rule_id` (FK), `postgres_definition`
- **`postgres_columns`**: –ø–æ–ª–µ `computed_function_mapping_rule_id` (FK), `postgres_computed_definition`
- **`postgres_check_constraints`**: –ø–æ–ª–µ `function_mapping_rule_id` (FK), `postgres_definition`
- **`postgres_indexes`**: –ø–æ–ª–µ `function_mapping_rule_id` (FK), `postgres_definition`

## –≠—Ç–∞–ø—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞–ø–ø–∏–Ω–≥–∞

### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
1. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö
2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤** –ø–æ —Ç–∏–ø–∞–º (default constraints, computed columns, etc.)
3. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π** –≤ —Ç–µ–∫—Å—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 2: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
1. **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π** —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –º–∞–ø–ø–∏–Ω–≥–∞
2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π** —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** —Å PostgreSQL –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏

### –≠—Ç–∞–ø 3: –í–∞–ª–∏–¥–∞—Ü–∏—è
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è** –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞** PostgreSQL –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è** –ø—Ä–∞–≤–∏–ª –º–∞–ø–ø–∏–Ω–≥–∞

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º –º–∏–≥—Ä–∞—Ü–∏–∏

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç—Ç–∞–ø–∞ "–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã"
```python
def create_table_structure_with_mapping(table_id: int, task_id: int) -> bool:
    # 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å PostgreSQL –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
    structure = get_table_structure_with_postgres_definitions(table_id, task_id)
    
    # 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º postgres_definition
    ddl = generate_postgres_ddl_with_mapped_functions(structure)
    
    # 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL
    return execute_postgres_ddl(ddl)
```

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —ç—Ç–∞–ø–∞ "–ü–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö"
```python
def migrate_table_data_with_mapping(table_id: int, task_id: int) -> bool:
    # 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –º–∞–ø–ø–∏–Ω–≥–æ–º
    structure = get_table_structure_with_postgres_definitions(table_id, task_id)
    
    # 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —É—á–µ—Ç–æ–º –º–∞–ø–ø–∏–Ω–≥–∞
    data = extract_data_with_function_mapping(structure)
    
    # 3. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ PostgreSQL
    return load_data_to_postgres(data)
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞–ø–ø–∏–Ω–≥–∞ (–¥–ª—è –∑–∞–¥–∞—á–∏ ID=2)
- **Default constraints —Å getdate()**: 17 —Å–ª—É—á–∞–µ–≤ ‚Üí `NOW()`
- **Computed columns —Å isnull()**: 22 —Å–ª—É—á–∞—è ‚Üí `COALESCE()`
- **Computed columns —Å convert()**: 15 —Å–ª—É—á–∞–µ–≤ ‚Üí `CAST()`
- **Computed columns —Å year()**: 3 —Å–ª—É—á–∞—è ‚Üí `EXTRACT()`
- **Computed columns —Å month()**: 2 —Å–ª—É—á–∞—è ‚Üí `EXTRACT()`
- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: 59 —Å–ª—É—á–∞–µ–≤ (100%)

## –§—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –º–∞–ø–ø–∏–Ω–≥–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `apply_function_mapping(definition: str, rule_id: int) -> str`
- `map_default_constraints_functions(task_id: int) -> int`
- `map_computed_columns_functions(task_id: int) -> int`
- `map_check_constraints_functions(task_id: int) -> int`
- `map_indexes_functions(task_id: int) -> int`

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `get_function_mapping_statistics(task_id: int) -> Dict`
- `validate_function_mapping_coverage(task_id: int) -> bool`
- `generate_mapping_report(task_id: int) -> str`

## üéØ –ü–†–ò–ù–¶–ò–ü –ù–ï–ë–õ–û–ö–ò–†–£–Æ–©–ï–ô –ú–ò–ì–†–ê–¶–ò–ò –î–õ–Ø –ù–ï–ó–ê–ú–ê–ü–ü–ò–†–û–í–ê–ù–ù–´–• –§–£–ù–ö–¶–ò–ô

**–ù–µ–∑–∞–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –ù–ï –ë–õ–û–ö–ò–†–£–Æ–¢ –ø–æ–ª–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é**, –ø–æ—Å–∫–æ–ª—å–∫—É:
1. **–ë–∞–∑–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è** (—Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏)
2. **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–æ** –∏–ª–∏ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ–∑–∂–µ
3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–≤–æ–ª—è–µ—Ç** –ø–æ—Å—Ç-–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –¥–æ—Ä–∞–±–æ—Ç–∫—É

## –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∑–∞–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –£—Ä–æ–≤–µ–Ω—å 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞–ø–ø–∏–Ω–≥ (80% —Å–ª—É—á–∞–µ–≤)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞: `getdate‚ÜíNOW`, `isnull‚ÜíCOALESCE`, `len‚ÜíLENGTH`
- –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (>80%) ‚Üí –ø—Ä–∏–º–µ–Ω—è–µ–º –º–∞–ø–ø–∏–Ω–≥

### –£—Ä–æ–≤–µ–Ω—å 2: –ü–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞–ø–ø–∏–Ω–≥ (15% —Å–ª—É—á–∞–µ–≤)
- –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (50-80%) ‚Üí –º–∞–ø–ø–∏–Ω–≥ + –≤–∞–ª–∏–¥–∞—Ü–∏—è
- –ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞ ‚Üí –ø–æ–º–µ—á–∞–µ–º –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –æ–±–∑–æ—Ä–∞

### –£—Ä–æ–≤–µ–Ω—å 3: –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (5% —Å–ª—É—á–∞–µ–≤)
- –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (<50%) ‚Üí –ø–æ–º–µ—á–∞–µ–º –¥–ª—è —Ä—É—á–Ω–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å–∏ –≤ `computed_columns_mapping_issues`

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –º–∞–ø–ø–∏–Ω–≥–∞

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫
1. **–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è** - —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –º–∞–ø–ø–∏–Ω–≥–∞
2. **–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞** - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ PostgreSQL –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–∞–≤–∏–ª** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª –¥–ª—è –æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
4. **–ù–µ–∑–∞–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - —Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É—é—â–∏–µ —Ä—É—á–Ω–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `function_mapping_rules`
2. **–†—É—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ `computed_columns_mapping_issues`
4. **–°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π** - —Ç–æ–ª—å–∫–æ —Å –∑–∞–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
5. **–ü–æ—Å—Ç-–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

## –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–µ—Ç–∞–ª–∏

### üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º –º–∏–≥—Ä–∞—Ü–∏–∏
- **[MIGRATION_ALGORITHM.md](../overview/MIGRATION_ALGORITHM.md)** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º –º–∏–≥—Ä–∞—Ü–∏–∏

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- **[MODULE_ARCHITECTURE.md](../architecture/MODULE_ARCHITECTURE.md)** - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

### üìã –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
- **[../../operations/rules/function_mapping/](../../operations/rules/function_mapping/)** - –ü—Ä–∞–≤–∏–ª–∞ –º–∞–ø–ø–∏–Ω–≥–∞ —Ñ—É–Ω–∫—Ü–∏–π

### üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **[ERROR_HANDLING.md](../development/ERROR_HANDLING.md)** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –º–∞–ø–ø–∏–Ω–≥–∞

### üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **[TECHNICAL_IMPLEMENTATION.md](../development/TECHNICAL_IMPLEMENTATION.md)** - –î–µ—Ç–∞–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)