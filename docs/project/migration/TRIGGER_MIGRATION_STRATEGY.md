# üîß –°–¢–†–ê–¢–ï–ì–ò–Ø –ú–ò–ì–†–ê–¶–ò–ò –¢–†–ò–ì–ì–ï–†–û–í FEMCL

## üìã –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –º–∏–≥—Ä–∞—Ü–∏–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏–∑ MS SQL Server –≤ PostgreSQL —Å —É—á–µ—Ç–æ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

---

## üéØ –û–ë–ó–û–† –ü–†–û–ë–õ–ï–ú–´

### ‚ö†Ô∏è **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**
–¢—Ä–∏–≥–≥–µ—Ä—ã –≤ MS SQL Server –∏ PostgreSQL –∏–º–µ—é—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –º–∏–≥—Ä–∞—Ü–∏—é —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–µ–π.

### üìä **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ FEMCL**
- **–í—Å–µ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:** 15
- **–¢–∞–±–ª–∏—Ü —Å —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏:** 7 –∏–∑ 166 (4.2%)
- **–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É:** 2.1

### üìä **–¢–∏–ø—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ**
1. **INSTEAD OF —Ç—Ä–∏–≥–≥–µ—Ä—ã** - 1 (6.7%) - –∑–∞–º–µ–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏—é
2. **AFTER —Ç—Ä–∏–≥–≥–µ—Ä—ã** - 14 (93.3%) - –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **DDL —Ç—Ä–∏–≥–≥–µ—Ä—ã** - 0 - –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
4. **LOGON —Ç—Ä–∏–≥–≥–µ—Ä—ã** - 0 - –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã

---

## üîÑ –°–¢–†–ê–¢–ï–ì–ò–Ø –ú–ò–ì–†–ê–¶–ò–ò

### üìä **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**

#### ‚úÖ **–ü—Ä–æ—Å—Ç—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (33.3% - 5 –∏–∑ 15)**
- **st_delete, stCost_delete, stCost_insert, stIpg_delete, stIpg_insert**
- **–ü–∞—Ç—Ç–µ—Ä–Ω:** –ü—Ä–æ—Å—Ç—ã–µ –∏–º–µ–Ω–∞ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** 95%

#### ‚ö†Ô∏è **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (40.0% - 6 –∏–∑ 15)**
- **rgTaxIdNumJurPers_*, rgTaxMnStRegNumInd_***
- **–ü–∞—Ç—Ç–µ—Ä–Ω:** –°–ª–æ–∂–Ω—ã–µ –∏–º–µ–Ω–∞ —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏ _del_aftr, _ins_inst, _upd_inst
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** 70%

#### ‚ùå **–°–ª–æ–∂–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (6.7% - 1 –∏–∑ 15)**
- **tr_InsteadOfInsert** - INSTEAD OF —Ç—Ä–∏–≥–≥–µ—Ä
- **–ü–∞—Ç—Ç–µ—Ä–Ω:** INSTEAD OF —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** 10%

#### ‚ùì **–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (20.0% - 3 –∏–∑ 15)**
- **del_aftr, ins_inst, upd_inst** - –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–º–µ–Ω–∞
- **–ü–∞—Ç—Ç–µ—Ä–Ω:** –¢—Ä–µ–±—É—é—Ç –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** 50%

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –†–ï–®–ï–ù–ò–Ø

### üìã **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã**

#### 1. **TriggerClassifier**
```python
class TriggerClassifier:
    """–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"""
    
    def classify_trigger(self, trigger_name: str, trigger_type: str) -> str:
        """–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"""
        
        if trigger_type == "INSTEAD OF":
            return "manual"
        elif self.is_simple_trigger(trigger_name):
            return "automatic"
        elif self.is_standard_trigger(trigger_name):
            return "semi_automatic"
        else:
            return "unknown"
    
    def is_simple_trigger(self, trigger_name: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π —Ç—Ä–∏–≥–≥–µ—Ä –ø–æ –∏–º–µ–Ω–∏"""
        simple_patterns = [
            "st_delete", "stCost_delete", "stCost_insert", 
            "stIpg_delete", "stIpg_insert"
        ]
        return trigger_name in simple_patterns
```

#### 2. **SimpleTriggerCreator**
```python
class SimpleTriggerCreator:
    """–°–æ–∑–¥–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤"""
    
    def create_audit_trigger(self, table_name: str) -> str:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –∞—É–¥–∏—Ç–∞"""
        return f"""
        CREATE OR REPLACE FUNCTION ags.audit_{table_name}()
        RETURNS TRIGGER AS $$
        BEGIN
            INSERT INTO ags.audit_log (table_name, operation, record_id, timestamp)
            VALUES ('{table_name}', TG_OP, COALESCE(NEW.id, OLD.id), CURRENT_TIMESTAMP);
            RETURN COALESCE(NEW, OLD);
        END;
        $$ LANGUAGE plpgsql;
        
        CREATE TRIGGER trg_{table_name}_audit
            AFTER INSERT OR UPDATE OR DELETE ON ags.{table_name}
            FOR EACH ROW
            EXECUTE FUNCTION ags.audit_{table_name}();
        """
```

#### 3. **StandardTriggerCreator**
```python
class StandardTriggerCreator:
    """–°–æ–∑–¥–∞—Ç–µ–ª—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ —Å —à–∞–±–ª–æ–Ω–∞–º–∏"""
    
    def create_validation_trigger(self, table_name: str, validation_rules: dict) -> str:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"""
        conditions = []
        for column, rule in validation_rules.items():
            if rule['type'] == 'not_null':
                conditions.append(f"NEW.{column} IS NULL")
            elif rule['type'] == 'range':
                conditions.append(f"NEW.{column} NOT BETWEEN {rule['min']} AND {rule['max']}")
        
        return f"""
        CREATE OR REPLACE FUNCTION ags.validate_{table_name}()
        RETURNS TRIGGER AS $$
        BEGIN
            IF {' OR '.join(conditions)} THEN
                RAISE EXCEPTION 'Validation failed for {table_name}';
            END IF;
            RETURN NEW;
        END;
        $$ LANGUAGE plpgsql;
        
        CREATE TRIGGER trg_{table_name}_validation
            BEFORE INSERT OR UPDATE ON ags.{table_name}
            FOR EACH ROW
            EXECUTE FUNCTION ags.validate_{table_name}();
        """
```

#### 4. **ComplexTriggerHandler**
```python
class ComplexTriggerHandler:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–ª–æ–∂–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤"""
    
    def analyze_complex_trigger(self, trigger_definition: str) -> dict:
        """–ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞"""
        analysis = {
            'complexity': 'high',
            'requires_manual_review': True,
            'estimated_effort': '2-4 hours',
            'dependencies': [],
            'notes': []
        }
        
        if 'EXEC' in trigger_definition.upper():
            analysis['dependencies'].append('stored_procedures')
            analysis['notes'].append('Contains stored procedure calls')
        
        if 'CURSOR' in trigger_definition.upper():
            analysis['complexity'] = 'very_high'
            analysis['estimated_effort'] = '4-8 hours'
            analysis['notes'].append('Contains cursor operations')
        
        return analysis
```

---

## üìã –ü–õ–ê–ù –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### üîÑ **–≠—Ç–∞–ø 1.2: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Ç–∞–±–ª–∏—Ü**

#### ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–ø—Ä–æ—Å—Ç—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã)**
1. **–ê–Ω–∞–ª–∏–∑ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
2. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - –∞—É–¥–∏—Ç, timestamp, –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª –º–∏–≥—Ä–∞—Ü–∏–∏

#### ‚ö†Ô∏è **–ü–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã)**
1. **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –∏ –ø—Ä–∞–≤–∏–ª
2. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
3. **–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

#### ‚ùå **–†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (—Å–ª–æ–∂–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã)**
1. **–û—Ç–ª–æ–∂–µ–Ω–∏–µ** - –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞ –≠—Ç–∞–ø 2
2. **–ê–Ω–∞–ª–∏–∑** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏
3. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
4. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è** - —Ä—É—á–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ PostgreSQL

### üîÑ **–≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ë–î**

#### ‚ùå **–†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (—Å–ª–æ–∂–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã)**
1. **–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –ø–æ–¥ PostgreSQL
3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - —Ä—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìä –û–¶–ï–ù–ö–ê –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–ò

### üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)**

| –¢–∏–ø —Ç—Ä–∏–≥–≥–µ—Ä–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ | –í—Ä–µ–º—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É |
|--------------|---------------|-------------------------|------------------|
| –ü—Ä–æ—Å—Ç—ã–µ (delete, insert) | 95% | 33.3% (5 –∏–∑ 15) | 5-10 –º–∏–Ω—É—Ç |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ (—Å–ª–æ–∂–Ω—ã–µ –∏–º–µ–Ω–∞) | 70% | 40.0% (6 –∏–∑ 15) | 30-60 –º–∏–Ω—É—Ç |
| –°–ª–æ–∂–Ω—ã–µ (INSTEAD OF) | 10% | 6.7% (1 –∏–∑ 15) | 2-8 —á–∞—Å–æ–≤ |
| –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ | 50% | 20.0% (3 –∏–∑ 15) | 1-2 —á–∞—Å–∞ |

### üéØ **–†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
- **33.3% —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - –ø—Ä–æ—Å—Ç—ã–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)
- **40.0% —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ (–ø–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)
- **6.7% —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - —Å–ª–æ–∂–Ω—ã–µ (—Ä—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)
- **20.0% —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** - –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –∞–Ω–∞–ª–∏–∑–∞)

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### üìã **–°—Ö–µ–º–∞ mcl –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (—Ä–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)**

#### **mcl.mssql_triggers**
```sql
-- –†–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã
CREATE TABLE mcl.mssql_triggers (
    id SERIAL PRIMARY KEY,
    table_id INTEGER REFERENCES mcl.mssql_tables(id),
    trigger_name VARCHAR(255) NOT NULL,
    trigger_type VARCHAR(50) NOT NULL,
    event_type VARCHAR(50) NOT NULL,
    is_disabled BOOLEAN DEFAULT FALSE,
    is_not_for_replication BOOLEAN DEFAULT FALSE,
    definition TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### **mcl.postgres_triggers**
```sql
-- –†–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã
CREATE TABLE mcl.postgres_triggers (
    id SERIAL PRIMARY KEY,
    table_id INTEGER REFERENCES mcl.postgres_tables(id),
    trigger_name VARCHAR(255) NOT NULL,
    trigger_type VARCHAR(50) NOT NULL,
    trigger_event VARCHAR(50) NOT NULL,
    function_name VARCHAR(255) NOT NULL,
    migration_status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### üìã **–ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏**

#### 1. **–ê–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**
```sql
-- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏–∑ mcl.mssql_triggers
SELECT 
    mt.trigger_name,
    mt.trigger_type,
    mt.event_type,
    t.object_name as table_name,
    mt.definition
FROM mcl.mssql_triggers mt
JOIN mcl.mssql_tables t ON mt.table_id = t.id
WHERE t.task_id = 2
ORDER BY t.object_name, mt.trigger_name;
```

#### 2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**
```python
def classify_triggers(triggers_data):
    """–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"""
    classified = {
        'automatic': [],
        'semi_automatic': [],
        'manual': [],
        'unknown': []
    }
    
    for trigger in triggers_data:
        complexity = TriggerClassifier().classify_trigger(
            trigger['trigger_name'], 
            trigger['trigger_type']
        )
        classified[complexity].append(trigger)
    
    return classified
```

#### 3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**
```python
def create_simple_triggers(table_name, triggers):
    """–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤"""
    creator = SimpleTriggerCreator()
    
    for trigger in triggers:
        trigger_name = trigger['trigger_name']
        event_type = trigger['event_type']
        
        if 'delete' in trigger_name.lower():
            ddl = creator.create_delete_trigger(table_name, trigger_name)
        elif 'insert' in trigger_name.lower():
            ddl = creator.create_insert_trigger(table_name, trigger_name)
        else:
            ddl = creator.create_generic_trigger(table_name, trigger_name, event_type)
        
        execute_ddl(ddl)
        log_trigger_creation(table_name, trigger_name, 'automatic')
```

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ **–ß—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å**
1. **–ü—Ä–æ—Å—Ç—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∞—É–¥–∏—Ç–∞** - –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–¢—Ä–∏–≥–≥–µ—Ä—ã timestamp** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–ü—Ä–æ—Å—Ç—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ NOT NULL, –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
4. **–¢—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–¥—Å—á–µ—Ç–∞** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤

### ‚ö†Ô∏è **–ß—Ç–æ –ø–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å**
1. **–¢—Ä–∏–≥–≥–µ—Ä—ã —Å —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π** - IF/ELSE –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
2. **–¢—Ä–∏–≥–≥–µ—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π** - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **–¢—Ä–∏–≥–≥–µ—Ä—ã –ø—Ä–æ–≤–µ—Ä–æ–∫** - —Å–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### ‚ùå **–ß—Ç–æ –¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é**
1. **–¢—Ä–∏–≥–≥–µ—Ä—ã —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π** - —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
2. **–¢—Ä–∏–≥–≥–µ—Ä—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –≤—ã–∑–æ–≤–∞–º–∏** - –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä/—Ñ—É–Ω–∫—Ü–∏–π
3. **–¢—Ä–∏–≥–≥–µ—Ä—ã —Å –∫—É—Ä—Å–æ—Ä–∞–º–∏** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
4. **INSTEAD OF —Ç—Ä–∏–≥–≥–µ—Ä—ã** - –∑–∞–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π

### üìã **–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã**
1. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
2. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
3. **–ü–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
4. **–†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
6. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –û–¢–ß–ï–¢–ù–û–°–¢–¨

### üìà **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞**
- **–ü—Ä–æ—Ü–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏** - –¥–æ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
- **–í—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏** - –æ–±—â–µ–µ –≤—Ä–µ–º—è –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—é —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫** - —á–∏—Å–ª–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏
- **–ö–∞—á–µ—Å—Ç–≤–æ –º–∏–≥—Ä–∞—Ü–∏–∏** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### üìã **–û—Ç—á–µ—Ç—ã**
- **–û—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- **–û—Ç—á–µ—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è
- **–û—Ç—á–µ—Ç –ø–æ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ** - —Å–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–ª—è —Ä—É—á–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
- **–û—Ç—á–µ—Ç –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 27 —è–Ω–≤–∞—Ä—è 2025*
*–ê–≤—Ç–æ—Ä: AI Assistant*
*–°—Ç–∞—Ç—É—Å: –ê–ö–¢–£–ê–õ–¨–ù–´–ô*